<div class="col m-3">
  <div class="col-md-12 mb-3">
    <div class="col-md-12 mb-3 mt-3">
      <h2>Nouvelle commande {{origin}}</h2>
    </div>
    <div class="alert alert-danger" *ngIf="errorMsg.length">
    <div *ngFor="let msg of errorMsg">
      <span> {{msg}}</span>
    </div>
  </div>
    <div class="row p-3 custom-border">

      <div class="col-md-5 custom-border-right">
        <form>
            <div class="form-group mb-3">
              <label for="codecmd" class="form-label"><strong>Code commande</strong></label>
              <input type="text" class="form-control" id="codecmd" placeholder="Saisir le code de la commande" name="codecmd" [(ngModel)]="codeCommande" >
            </div>
            <div class="form-group mb-3">
              <label for="datecommande" class="form-label"><strong>Date commande</strong></label>
              <input type="date" class="form-control" id="datecommande" placeholder="Date de la commande">
            </div>
          <div class="form-group mb-3">
            <label for="cltfrs" class="form-label"><strong>{{ origin === 'client' ? 'Client' : 'Fournisseur' }}</strong></label>
            <select class="form-control" id="cltfrs" aria-label="Default select example" name="cltfrs" [(ngModel)]="selectedClientFournisseur">
              <option selected>Sélectionner un {{ origin }}</option>
              <option *ngFor="let obj of listClientsFournisseurs" [ngValue]="obj">
                {{ obj.nom }}&nbsp;{{obj.prenom}}
              </option>
            </select>
          </div>
        </form>

      </div>

      <div class="col-md-5 custom-border-right" *ngIf="selectedClientFournisseur.nom">
        <div class="col">
          <div class="row">
            <div class="col-md-1"><i class="fas fa-info-circle blue-color"></i> </div>
            <div class="col-11">Nom: {{ selectedClientFournisseur.nom }}</div>
          </div>
          <div class="row">
            <div class="col-md-1"><i class="fas fa-info-circle blue-color"></i> </div>
            <div class="col-md-11">Prenom: {{ selectedClientFournisseur.prenom }}</div>
          </div>
          <div class="row">
            <div class="col-md-1"><i class="fas fa-phone-alt blue-color"></i> </div>
            <div class="col-md-11">Tel: {{ selectedClientFournisseur.numTel }} </div>
          </div>
          <div class="row">
            <div class="col-md-1"><i class="fas fa-hourglass-half blue-color"></i> </div>
            <div class="col-md-11 text-primary">En preparation</div>
          </div>
        </div>
      </div>

      <div class="col-md-2 text-center" *ngIf="selectedClientFournisseur.nom">
        <img [src]="selectedClientFournisseur.photo ? selectedClientFournisseur.photo : 'product.png'" alt="" class="rounded-circle" width="150px">
      </div>
    </div>

    <div class="row mt-2 p-3 custom-border">

      <form >
        <div class="form-row row">
          <div class="col-md-3">
            <label for="codearticle" class="form-label"><strong>Code article</strong></label>
            <input type="text" class="form-control" id="codearticle" placeholder="Rechercher un article" name="codearticle" [(ngModel)]="codeArticle" (input)="searchArticle()">
            <div *ngIf="codeArticle.length && !articleNotYetSelected" class="autocomplete shadow p-3 bg-white rounded">
              <p class="p-1" *ngFor="let article of listArticle"
                  (click)="selectArticle(article)"
              >
                {{article.codeArticle}}&nbsp; {{article.designation}}
              </p>
            </div>
          </div>
          <div class="col-md-4">
            <label for="quantite" class="form-label"><strong>Quantité</strong></label>
            <input type="number" class="form-control" id="quantite" placeholder="Saisir la quantité" name="quantite" [(ngModel)]="quantite">
          </div>
          <div class="col-md-4">
            <label for="prixunitttc" class="form-label"><strong>Prix unitaire (€)</strong></label>
            <input type="number" class="form-control" id="prixunitttc" placeholder="Prix unitaire TTC" name="prixunitttc" [(ngModel)]="searchArticleDto.prixUnitaireTtc">
          </div>
          <div class="col-md-1 d-flex align-items-end">
            <button type="button" class="btn btn-success" (click)="ajouterLigneCommande()" title="Ajouter l'article">
              <i class="fas fa-plus"></i>
            </button>
          </div>
        </div>
      </form>
    </div>
    <div class="row mt-2 p-3 custom-border" style="max-height: 300px; overflow-y: scroll">
      <div class="col-md-12">
        <app-detail-cmd
        *ngFor="let ligne of lignesCommande"
        [ligneCommande]="ligne"
        ></app-detail-cmd>

      </div>

    </div>
    <div class="row mt-2 p-3 custom-border text-end">
      <h3>Total de la commande: {{ totalCommande }}</h3>
    </div>
  </div>



  <div class="col-md-12 text-end mt-2">
    <button class="btn btn-danger me-3" (click)="cancel()">
      <i class="fas fa-ban"></i>&nbsp;
      Annuler
    </button>
    <button class="btn btn-primary" (click)="enregistrerCommande()">
      <i class="fas fa-save"></i>&nbsp;
      Enregistrer
    </button>
  </div>
</div>

